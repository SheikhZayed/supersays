<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<script src="https://www.gstatic.com/firebasejs/4.12.1/firebase.js"></script>
<script type="text/javascript">
  var config = {
  apiKey: "AIzaSyBr7xarwCbbm2NXpp6yt1RiieXmahzstc0",
  authDomain: "super-says.firebaseapp.com",
  databaseURL: "https://super-says.firebaseio.com",
  projectId: "super-says",
  storageBucket: "super-says.appspot.com",
  messagingSenderId: "942871960205"
};
firebase.initializeApp(config);
</script>
<script src="https://aframe.io/releases/0.8.0/aframe.min.js"></script>
<script src="https://unpkg.com/aframe-environment-component@1.0.0/index.js"></script>
<script src="https://unpkg.com/aframe-animation-component@4.1.1/dist/aframe-animation-component.min.js"></script>
<script src="https://unpkg.com/aframe-proxy-event-component@1.1.1/dist/aframe-proxy-event-component.min.js"></script>
<script src="https://unpkg.com/aframe-haptics-component@1.4.1/dist/aframe-haptics-component.min.js"></script>
<script src="supersays.js"></script>
<script src="highscores.js"></script>
<script src="simple-keyboard.js"></script>
<script src="button.js"></script>
</head>
<body>
  <a-scene>
    <a-assets>
      <audio id="sound-note0" src="assets/0.ogg"></audio>
      <audio id="sound-note1" src="assets/1.ogg"></audio>
      <audio id="sound-note2" src="assets/3.ogg"></audio>
      <audio id="sound-note3" src="assets/2.ogg"></audio>
      <audio id="gong" src="assets/gong.ogg"></audio>
      <audio id="loop" src="assets/loop.ogg"></audio>
      <audio id="fail" src="assets/fail.ogg"></audio>
      <a-mixin id="sector" scale="1 0.05 1" geometry="segmentsHeight:8;segmentsWidth:16;primitive:sphere;phiLength:90;thetaLength:90; radius: 0.4" material="roughness:0.39"></a-mixin>
      <a-mixin id="sectorbase" position="0 -10 0" geometry="openEnded:true; height:20; radius:0.37; segmentsHeight:8; segmentsRadial:16; primitive:cylinder; thetaLength:90; thetaStart:-90" material="roughness:0.39"></a-mixin>

      <a-mixin id="emissive-anim" animation__emissive="property: material.emissiveIntensity; from: 1.0; to: 0.0; dur: 300; easing: easeInCubic; startEvents: hit"></a-mixin>
      <a-mixin id="pos-anim" animation__pos="property: position; from: 0 -0.015 0; to: 0 0 0; dur: 70; easing: easeInCubic; startEvents: hitpos"></a-mixin>
      <a-mixin id="font" text="align: center; width: 3; font: exo2bold; letterSpacing: -1"></a-mixin>
      <a-mixin id="highscorefont" mixin="font" text="width: 1.5; wrapCount: 15"></a-mixin>
    </a-assets>
    <a-entity environment="preset: poison; skyColor: #1a1a1a; horizonColor: #154a55; lightPosition: 0 2.34 1; fog: 0.87; ground: hills; groundYScale: 2.83; groundColor: #171717; groundColor2: #161616; dressing: none; grid: 1x1; gridColor: #207384"></a-entity>

    <a-entity simple-keyboard position="0 1.4 -1"></a-entity>

    <a-entity id="lefthand" 
      vive-controls="hand: left; model:false" 
      oculus-touch-controls="hand: left; model:false" 
      haptics="dur: 40"
      >
      <a-sphere radius="0.04" material="transparent: true; opacity: 0.3; color: #5bb4f4; emissive: #5bb4f4; emissiveIntensity: 0.4"
        animation__emissive="property: material.emissiveIntensity; from: 1.0; to: 0.4; dur: 800; startEvents: hit"
        animation__opacity ="property: material.opacity; from: 1.0; to: 0.3; dur: 800; startEvents: hit"
      ></a-sphere>
    </a-entity>
    <a-entity id="righthand" 
      vive-controls="hand: right; model:false" 
      oculus-touch-controls="hand: right; model:false"
      haptics="dur: 40"
      >
      <a-sphere radius="0.04" material="transparent: true; opacity: 0.3; color: #5bb4f4; emissive: #5bb4f4; emissiveIntensity: 0.4"
        animation__emissive="property: material.emissiveIntensity; from: 1.0; to: 0.4; dur: 800; startEvents: hit"
        animation__opacity ="property: material.opacity; from: 1.0; to: 0.3; dur: 800; startEvents: hit"
      ></a-sphere>
    </a-entity>

    <a-entity id="super"  position="0 1 -0.7" rotation="0 0 0"
      supersays
      proxy-event="event: gameover; to: #startbutton, #messages, #board, #clockbg, #soundfail; as: gameover"
    >
      <a-entity id="note0" rotation="0 0 0" mixin="sector emissive-anim pos-anim" material="color:#800"
        animation__color ="property: material.color; from: #F00; to: #800; dur: 300; startEvents: hit">
        <a-entity mixin="sectorbase" material="color:#800"
          animation__color ="property: material.color; from: #F00; to: #800; dur: 300; startEvents: hit"></a-entity>
        <a-entity sound="src:#sound-note0; on: hit; poolSize: 20"></a-entity>
      </a-entity>
      <a-entity id="note1" rotation="0 90 0" mixin="sector emissive-anim pos-anim" material="color:#008"
        animation__color ="property: material.color; from: #00F; to: #008; dur: 300; startEvents: hit">
        <a-entity mixin="sectorbase" material="color:#008"
          animation__color ="property: material.color; from: #00F; to: #008; dur: 300; startEvents: hit"></a-entity>
        <a-entity sound="src:#sound-note1; on: hit; poolSize: 20"></a-entity>
      </a-entity>
      <a-entity id="note2" rotation="0 180 0" mixin="sector emissive-anim pos-anim" material="color:#880"
        animation__color ="property: material.color; from: #FF0; to: #880; dur: 300; startEvents: hit">
        <a-entity mixin="sectorbase" material="color:#880"
          animation__color ="property: material.color; from: #FF0; to: #880; dur: 300; startEvents: hit"></a-entity>
        <a-entity sound="src:#sound-note2; on: hit; poolSize: 20"></a-entity>
      </a-entity>
      <a-entity id="note3" rotation="0 270 0" mixin="sector emissive-anim pos-anim" material="color:#080"
        animation__color ="property: material.color; from: #0F0; to: #080; dur: 300; startEvents: hit">
        <a-entity mixin="sectorbase" material="color:#080"
          animation__color ="property: material.color; from: #0F0; to: #080; dur: 300; startEvents: hit"></a-entity>
        <a-entity sound="src:#sound-note3; on: hit; poolSize: 20"></a-entity>
      </a-entity>

      <a-entity id="clockbg" position="0 -2 -0.6" rotation="-30 0 0" geometry="primitive:plane;width:0.8;height:0.03" material="shader:flat;color:#ccc;transparent:true;opacity:0.16"
        animation__pos="property: position; from: 0 -2 -0.6; to: 0 0.14 -0.6; dur: 1600; easing: easeOutElastic; delay: 650; startEvents: startgame"
        animation__pos2="property: position; to: 0 -2 -0.6; from: 0 0.14 -0.6; dur: 1500; easing: easeInOutCubic; delay: 3000; startEvents: gameover"
        >
        <a-entity position="0 0 0.01" id="clock" scale="1 1 1" geometry="primitive:plane;width:0.8;height:0.03" material="shader:flat;color:#ccc"></a-entity>
      </a-entity>
    </a-entity>

    <a-entity geometry="height:0.38;width:0.17" position="0 1.614 -0.747" id="starthit" rotation="0 90 0" visible="false"></a-entity>
    <a-entity id="startbutton" mixin="font" text="value: START; width: 6; color: #52ae2b" position="0 1.65 -0.7" button="hitTarget:#starthit"
      animation__enabled="property: button.enabled; from: true; to: false; startEvents: focus"
      animation__visible="property: visible; from: true; to: false; startEvents: focus; delay: 400"
      animation__color="property: text.color; from: #FFF; to: #6db4e7; startEvents: focus; dur: 400"
      animation__position="property: position; from: 0 1.65 -0.7; to: 0 1.65 -50; startEvents: focus; dur: 8000; easing: easeOutCubic"
      animation__opacity="property: text.opacity; from: 1; to: 0; startEvents: focus; dur: 400"

      animation__enabled2="property: button.enabled; from: false; to: true; delay: 4000; startEvents: gameover"
      animation__visible2="property: visible; from: false; to: true; delay: 4000; startEvents: gameover;"
      animation__color2="property: text.color; from: #FFF; to: #6db4e7; delay: 4000; startEvents: gameover; dur: 800"
      animation__position2="property: position; to: 0.0 1.65 -0.7; delay: 4000; startEvents: gameover; dur: 800; easing: easeOutElastic"
      animation__opacity2="property: text.opacity; from: 0; to: 1; delay: 4000; startEvents: gameover; dur: 800;"

      proxy-event="event: focus; to: #super, #board, #loopsound, #clockbg; as: startgame"
    >
      <a-entity sound="src:#gong; on: focus"></a-entity>
    </a-entity>
  
    <a-entity id="board" position="0 -2 -2.2"
        animation__pos="property: position; from: 0 -2 -2.2; to: 0 1.65 -2.2; dur: 1500; easing: easeOutElastic; delay: 600; startEvents: startgame"
        animation__pos2="property: position; from: 0 1.65 -2.2; to: 0 2.3 -2.4; dur: 1500; easing: easeInOutCubic; delay: 3000; startEvents: gameover"
      >
      <a-entity id="loopsound" sound="src:#loop; on: startgame; loop: true"></a-entity>
      <a-entity id="level" mixin="font" text="value:Level;width:2.5" position="-0.3 -0.049 0"></a-entity>
      <a-entity id="levelv" mixin="font" text="value:0;width:4;color:#31c2f2" position="-0.3 -0.19 0.04"></a-entity>
      <a-entity id="points" mixin="font" text="value:Points;width:2.5" position="0.3 -0.054 0"></a-entity>
      <a-entity id="pointsv" mixin="font" text="value:0;width:4.07;color:#f1dc49" position="0.3 -0.19 0.04"></a-entity>
      <a-entity id="messages" mixin="font" text="value:GAMEOVER;width:4.49;opacity:0;color:#E33" position="0 0.254 0.164"
        animation__opacity1="property: text.opacity; from: 0; to: 1; dur: 500; startEvents: show;"
        animation__position="property: position; from: 0 0.254 -0.2; to: 0 0.254 0.164; dur: 1000; easing: easeOutElastic; startEvents: show"
        animation__scale="property: scale; from: 1 1 1; to: 1.4 1.4 1.4; dur: 1000; easing: easeOutElastic; startEvents: show"
        animation__opacity2="property: text.opacity; from: 1; to: 0; dur: 1000; startEvents: show; delay: 4000">
      </a-entity>
      
      <a-entity id="soundfail" sound="src:#fail; on: gameover"></a-entity>

    </a-entity>

    <a-entity id="highscores" position="-3 3 -1.6" rotation="0 66 0">
      <a-entity mixin="font" text="value:High Scores; width:5" position="0 0 0.1"></a-entity>
      <a-entity highscores="spacing: 0.25" position="0 -0.4 0">
        <a-entity>
          <a-entity class="player" mixin="highscorefont" text="align: left; value: feiss; "></a-entity>
          <a-entity class="score" mixin="highscorefont" text="align: right; value: 32121321;"></a-entity>
        </a-entity>
        <a-entity>
          <a-entity class="player" mixin="highscorefont" text="align: left; value: feiss; "></a-entity>
          <a-entity class="score" mixin="highscorefont" text="align: right; value: 32121321;"></a-entity>
        </a-entity>
        <a-entity>
          <a-entity class="player" mixin="highscorefont" text="align: left; value: feiss; "></a-entity>
          <a-entity class="score" mixin="highscorefont" text="align: right; value: 32121321;"></a-entity>
        </a-entity>
        <a-entity>
          <a-entity class="player" mixin="highscorefont" text="align: left; value: feiss; "></a-entity>
          <a-entity class="score" mixin="highscorefont" text="align: right; value: 32121321;"></a-entity>
        </a-entity>
        <a-entity>
          <a-entity class="player" mixin="highscorefont" text="align: left; value: feiss; "></a-entity>
          <a-entity class="score" mixin="highscorefont" text="align: right; value: 32121321;"></a-entity>
        </a-entity>
        <a-entity>
          <a-entity class="player" mixin="highscorefont" text="align: left; value: feiss; "></a-entity>
          <a-entity class="score" mixin="highscorefont" text="align: right; value: 32121321;"></a-entity>
        </a-entity>
        <a-entity>
          <a-entity class="player" mixin="highscorefont" text="align: left; value: feiss; "></a-entity>
          <a-entity class="score" mixin="highscorefont" text="align: right; value: 32121321;"></a-entity>
        </a-entity>
        <a-entity>
          <a-entity class="player" mixin="highscorefont" text="align: left; value: feiss; "></a-entity>
          <a-entity class="score" mixin="highscorefont" text="align: right; value: 32121321;"></a-entity>
        </a-entity>
        <a-entity>
          <a-entity class="player" mixin="highscorefont" text="align: left; value: feiss; "></a-entity>
          <a-entity class="score" mixin="highscorefont" text="align: right; value: 32121321;"></a-entity>
        </a-entity>
        <a-entity>
          <a-entity class="player" mixin="highscorefont" text="align: left; value: feiss; "></a-entity>
          <a-entity class="score" mixin="highscorefont" text="align: right; value: 32121321;"></a-entity>
        </a-entity>

      </a-entity>

    </a-entity>
  </a-scene>
</body>
</html>

